import * as grpc from '@grpc/grpc-js';
import * as protoLoader from '@grpc/proto-loader';

var service = protoLoader.loadSync(
  "face.proto",
  {
    keepCase: true,
    longs: String,
    enums: String,
    defaults: true,
    oneofs: true
  })['face.FaceMatch'];
async function detect(call, callback) {
  try {
    callback(null, { points:[-0.1135791465640068,0.06519047915935516,0.0868750810623169,-0.03466637805104256,-0.14559723436832428,0.0012285765260457993,-0.027327461168169975,0.06552033871412277,0.1213182732462883,-0.09226315468549728,0.18348272144794464,-0.02734990417957306,-0.24301959574222565,0.063092440366745,-0.008693696931004524,0.03435593098402023,-0.12833066284656525,-0.04768776521086693,-0.08007469773292542,-0.04854067414999008,0.09662263095378876,0.07236946374177933,0.030402090400457386,0.06734399497509003,-0.12641313672065735,-0.3702910244464874,-0.05201135203242302,-0.09278469532728197,0.07348757237195969,-0.1004866510629654,0.008320096880197525,0.030270393937826157,-0.09001166373491287,0.04663763195276261,-0.017504628747701645,0.05844324827194214,-0.10879674553871156,-0.16307061910629272,0.2683044373989105,0.011655222624540327,-0.17053036391735077,-0.026669971644878387,-0.011932998895645142,0.27738475799560547,0.09950268268585204,-0.00648646242916584,0.012055747210979462,-0.023540472611784935,0.10882428288459778,-0.258967787027359,0.0912042111158371,0.22773081064224243,0.08516672253608704,0.10144108533859252,0.11135683953762054,-0.096153162419796,0.0884673222899437,0.12174883484840392,-0.17848822474479675,0.008588556200265884,0.01772419735789299,-0.08682052791118622,-0.01581498794257641,-0.13100673258304596,0.1651720106601715,0.13108603656291962,-0.1018800213932991,-0.0812874510884285,0.034753791987895966,-0.1605955958366394,-0.0807737186551094,0.07323863357305527,-0.11244599521160126,-0.16116738319396973,-0.16784074902534485,0.06108831241726875,0.3305567800998688,0.2320983409881592,-0.16439682245254517,0.021907534450292587,-0.041955579072237015,-0.06223037466406822,0.10782242566347122,0.10684676468372344,-0.13448470830917358,-0.030300676822662354,-0.0726548358798027,0.07524541020393372,0.11463604867458344,-0.020443890243768692,-0.03392111882567406,0.18746168911457065,0.07605686783790588,0.00948113575577736,0.046579860150814056,-0.03792954236268997,-0.12284566462039948,-0.026320692151784897,-0.05139655992388725,0.027188461273908615,0.0982760637998581,-0.1080954521894455,-0.030799739062786102,0.037006959319114685,-0.22259734570980072,0.16161325573921204,0.011044636368751526,-0.0716174840927124,0.07651420682668686,-0.03470322862267494,-0.13476012647151947,0.0032833367586135864,0.13037830591201782,-0.2566957175731659,0.1537594199180603,0.1148482710123062,0.03725587576627731,0.21166181564331055,0.09753082692623138,0.06673246622085571,-0.039546798914670944,-0.04022202640771866,-0.13814720511436462,-0.06793323159217834,0.10041230171918868,0.047358933836221695,0.04089009016752243,-0.033504582941532135] });
  } catch (error) {
    callback(error, null);
  }
}

async function matchDescriptors(call, callback) {
  try {
    callback(null, { distance:0.7 });
  } catch (error) {
    callback(error, null);
  }
}
async function matchDescriptorToImage(call, callback) {
  try {
    callback(null, { distance:0.7 });
  } catch (error) {
    callback(error, null);
  }
}
var server = new grpc.Server();
server.addService(service, {
  detect: detect,
  matchDescriptorToImage: matchDescriptorToImage,
  matchDescriptors: matchDescriptors
});
server.bindAsync('0.0.0.0:50051', grpc.ServerCredentials.createInsecure(), () => {
  server.start();
});
